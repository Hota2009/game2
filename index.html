<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مختبر الكيمياء التفاعلي</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }

        /* Lab Scene */
        .lab-scene {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(180deg, #e8f4f8 0%, #d1e7dd 100%);
        }

        /* Lab Wall */
        .lab-wall {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 70%;
            background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
            border-bottom: 3px solid #dee2e6;
        }

        /* Lab Table */
        .lab-table {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30%;
            background: linear-gradient(180deg, #8b7355 0%, #6d5a44 50%, #5a4835 100%);
            border-top: 2px solid #4a3a2a;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
        }

        /* Top UI Bar */
        .top-ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 15px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            z-index: 100;
        }

        .experiment-title {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .experiment-goal {
            font-size: 16px;
            color: #7f8c8d;
        }

        /* Left Panel - Chemical Materials */
        .materials-panel {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 200px;
            z-index: 50;
        }

        .materials-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .material-item {
            margin-bottom: 15px;
            cursor: move;
            transition: transform 0.2s;
            text-align: center;
            font-size: 12px;
            color: #34495e;
        }

        .material-item:hover {
            transform: scale(1.05);
        }

        .material-item.dragging {
            opacity: 0.5;
        }

        /* Bottle Styles */
        .bottle {
            width: 60px;
            height: 80px;
            margin: 0 auto 5px;
            position: relative;
            border-radius: 5px 5px 10px 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .bottle-neck {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 15px;
            background: inherit;
            border-radius: 3px 3px 0 0;
        }

        .bottle.hcl {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .bottle.naoh {
            background: linear-gradient(135deg, #4834d4 0%, #686de0 100%);
        }

        .bottle.cuso4 {
            background: linear-gradient(135deg, #22a6b3 0%, #7bed9f 100%);
        }

        /* Metal and Non-metal Styles */
        .metal-piece {
            width: 50px;
            height: 30px;
            margin: 0 auto 5px;
            background: linear-gradient(135deg, #c0c0c0 0%, #808080 50%, #c0c0c0 100%);
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .non-metal {
            width: 40px;
            height: 40px;
            margin: 0 auto 5px;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .non-metal.carbon {
            background: radial-gradient(circle, #2c3e50 0%, #000000 100%);
        }

        .non-metal.sulfur {
            background: radial-gradient(circle, #f1c40f 0%, #f39c12 100%);
        }

        /* Beaker Container */
        .beaker-container {
            position: absolute;
            left: 50%;
            top: 60%;
            transform: translate(-50%, -50%);
            z-index: 40;
        }

        /* Beaker */
        .beaker {
            width: 200px;
            height: 250px;
            position: relative;
            background: linear-gradient(135deg, 
                rgba(255,255,255,0.1) 0%, 
                rgba(255,255,255,0.05) 50%, 
                rgba(255,255,255,0.08) 100%);
            border: 3px solid rgba(150,150,150,0.9);
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        /* Glass reflection */
        .beaker::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 15px;
            width: 40px;
            height: 130px;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.6) 0%, 
                rgba(255,255,255,0.2) 50%, 
                transparent 100%);
            border-radius: 10px;
        }

        /* Additional glass highlight */
        .beaker::after {
            content: '';
            position: absolute;
            top: 20px;
            right: 15px;
            width: 25px;
            height: 80px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,0.3) 50%, 
                rgba(255,255,255,0.1) 100%);
            border-radius: 8px;
        }

        /* Liquid Container */
        .liquid-container {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            height: 50px;
            border-radius: 0 0 15px 15px;
            transition: all 0.5s ease;
            overflow: hidden;
        }

        /* Liquid Types */
        .liquid {
            width: 100%;
            height: 100%;
            transition: all 0.5s ease;
        }

        .liquid.acid {
            background: linear-gradient(180deg, 
                rgba(255,107,107,0.6) 0%, 
                rgba(238,90,36,0.8) 100%);
        }

        .liquid.base {
            background: linear-gradient(180deg, 
                rgba(72,52,212,0.6) 0%, 
                rgba(104,109,224,0.8) 100%);
        }

        .liquid.salt {
            background: linear-gradient(180deg, 
                rgba(255,255,255,0.4) 0%, 
                rgba(236,240,241,0.6) 100%);
        }

        .liquid.cuso4 {
            background: linear-gradient(180deg, 
                rgba(34,166,179,0.6) 0%, 
                rgba(123,237,159,0.8) 100%);
        }

        /* Bubbles */
        .bubbles {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            bottom: -20px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.4) 100%);
            border-radius: 50%;
            animation: rise 3s infinite ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #2c3e50;
        }

        .bubble.large {
            width: 40px;
            height: 40px;
            font-size: 12px;
            background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(200,200,200,0.6) 100%);
            border: 2px solid rgba(100,100,100,0.3);
        }

        @keyframes rise {
            0% {
                bottom: 200px;
                opacity: 0;
                transform: scale(0.5);
            }
            10% {
                opacity: 1;
                transform: scale(1);
            }
            90% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                bottom: 400px;
                opacity: 0;
                transform: scale(0.8);
            }
        }

        /* Precipitate */
        .precipitate {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(180deg, 
                rgba(236,240,241,0.9) 0%, 
                rgba(189,195,199,0.9) 100%);
            border-radius: 0 0 15px 15px;
            display: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Bottom UI Buttons */
        .bottom-ui {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
        }

        .ui-button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .ui-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .ui-button:active {
            transform: translateY(0);
        }

        /* Message Box */
        .message-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            display: none;
            z-index: 200;
            max-width: 400px;
        }

        .message-title {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .message-content {
            font-size: 16px;
            color: #34495e;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .close-button {
            padding: 8px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }

        /* Reaction Text */
        .reaction-text {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .reaction-text.show {
            opacity: 1;
        }

        /* Drop Zone Highlight */
        .beaker-container.drop-zone {
            border: 3px dashed #3498db;
            border-radius: 20px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="lab-scene">
        <!-- Lab Wall -->
        <div class="lab-wall"></div>
        
        <!-- Lab Table -->
        <div class="lab-table"></div>
        
        <!-- Top UI -->
        <div class="top-ui">
            <div class="experiment-title">تفاعلات كيميائية</div>
            <div class="experiment-goal">اسحب المواد الكيميائية إلى الكأس وشاهد التفاعلات</div>
        </div>
        
        <!-- Materials Panel -->
        <div class="materials-panel">
            <div class="materials-title">المواد الكيميائية</div>
            
            <div class="material-item" draggable="true" data-material="hcl">
                <div class="bottle hcl">
                    <div class="bottle-neck"></div>
                </div>
                <div>حمض (HCl)</div>
            </div>
            
            <div class="material-item" draggable="true" data-material="naoh">
                <div class="bottle naoh">
                    <div class="bottle-neck"></div>
                </div>
                <div>قاعدة (NaOH)</div>
            </div>
            
            <div class="material-item" draggable="true" data-material="cuso4">
                <div class="bottle cuso4">
                    <div class="bottle-neck"></div>
                </div>
                <div>محلول كبريتات النحاس</div>
            </div>
            
            <div class="material-item" draggable="true" data-material="metal">
                <div class="metal-piece"></div>
                <div>فلز (Mg/Zn)</div>
            </div>
            
            <div class="material-item" draggable="true" data-material="carbon">
                <div class="non-metal carbon"></div>
                <div>كربون (C)</div>
            </div>
            
            <div class="material-item" draggable="true" data-material="sulfur">
                <div class="non-metal sulfur"></div>
                <div>كبريت (S)</div>
            </div>
        </div>
        
        <!-- Beaker -->
        <div class="beaker-container">
            <div class="beaker">
                <div class="liquid-container">
                    <div class="liquid"></div>
                    <div class="bubbles"></div>
                    <div class="precipitate"></div>
                </div>
                <div class="reaction-text"></div>
            </div>
        </div>
        
        <!-- Bottom UI -->
        <div class="bottom-ui">
            <button class="ui-button" onclick="startReaction()">ابدأ التفاعل</button>
            <button class="ui-button" onclick="resetScene()">إعادة المحاولة</button>
            <button class="ui-button" onclick="showExplanation()">شرح التجربة</button>
        </div>
        
        <!-- Message Box -->
        <div class="message-box" id="messageBox">
            <div class="message-title" id="messageTitle">رسالة</div>
            <div class="message-content" id="messageContent">المحتوى</div>
            <button class="close-button" onclick="closeMessage()">إغلاق</button>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            materialsInBeaker: [],
            currentLiquid: null,
            reactionInProgress: false,
            liquidLevel: 50
        };

        // Initialize drag and drop
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
        });

        function initializeDragAndDrop() {
            const materials = document.querySelectorAll('.material-item');
            const beakerContainer = document.querySelector('.beaker-container');
            
            materials.forEach(material => {
                material.addEventListener('dragstart', handleDragStart);
                material.addEventListener('dragend', handleDragEnd);
            });
            
            beakerContainer.addEventListener('dragover', handleDragOver);
            beakerContainer.addEventListener('drop', handleDrop);
            beakerContainer.addEventListener('dragleave', handleDragLeave);
        }

        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'copy';
            e.dataTransfer.setData('material', e.target.dataset.material);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
            document.querySelector('.beaker-container').classList.add('drop-zone');
        }

        function handleDragLeave(e) {
            document.querySelector('.beaker-container').classList.remove('drop-zone');
        }

        function handleDrop(e) {
            e.preventDefault();
            document.querySelector('.beaker-container').classList.remove('drop-zone');
            
            const material = e.dataTransfer.getData('material');
            addMaterialToBeaker(material);
        }

        function addMaterialToBeaker(material) {
            if (gameState.materialsInBeaker.includes(material)) {
                showMessage('تنبيه', 'هذه المادة موجودة بالفعل في الكأس');
                return;
            }
            
            gameState.materialsInBeaker.push(material);
            updateBeakerContent();
            checkForReactions();
        }

        function updateBeakerContent() {
            const liquidContainer = document.querySelector('.liquid-container');
            const liquid = document.querySelector('.liquid');
            
            // Increase liquid level
            gameState.liquidLevel = Math.min(gameState.liquidLevel + 30, 200);
            liquidContainer.style.height = gameState.liquidLevel + 'px';
            
            // Set liquid color based on materials
            if (gameState.materialsInBeaker.length === 1) {
                const material = gameState.materialsInBeaker[0];
                liquid.className = 'liquid';
                
                switch(material) {
                    case 'hcl':
                        liquid.classList.add('acid');
                        break;
                    case 'naoh':
                        liquid.classList.add('base');
                        break;
                    case 'cuso4':
                        liquid.classList.add('cuso4');
                        break;
                    default:
                        liquid.style.background = 'linear-gradient(180deg, rgba(200,200,200,0.3) 0%, rgba(150,150,150,0.5) 100%)';
                }
            }
        }

        function checkForReactions() {
            const materials = gameState.materialsInBeaker;
            
            if (materials.length < 2) return;
            
            // Check for specific reactions
            if (materials.includes('hcl') && materials.includes('naoh')) {
                performAcidBaseReaction();
            } else if (materials.includes('metal') && materials.includes('hcl')) {
                performMetalAcidReaction();
            } else if (materials.includes('cuso4') && materials.includes('metal')) {
                performCopperSulfateMetalReaction();
            } else if ((materials.includes('carbon') || materials.includes('sulfur')) && materials.includes('hcl')) {
                showNoReactionMessage();
            }
        }

        function performAcidBaseReaction() {
            const liquid = document.querySelector('.liquid');
            liquid.className = 'liquid salt';
            createBubbles('gentle');
            createResultBubbles(['NaCl', 'H₂O']);
            showReactionText('حمض + قاعدة → ملح + ماء');
        }

        function performMetalAcidReaction() {
            createBubbles('strong');
            createResultBubbles(['H₂', 'ملح']);
            showReactionText('فلز + حمض → ملح + H₂↑');
        }

        function performCopperSulfateMetalReaction() {
            const liquid = document.querySelector('.liquid');
            liquid.style.background = 'linear-gradient(180deg, rgba(34,166,179,0.3) 0%, rgba(123,237,159,0.4) 100%)';
            document.querySelector('.precipitate').style.display = 'block';
            createBubbles('gentle');
            createResultBubbles(['Cu', 'ZnSO₄']);
        }

        function showNoReactionMessage() {
            showMessage('لا يحدث تفاعل', 'لا يحدث تفاعل لأن هذه مادة لافلزية');
        }

        function createBubbles(intensity) {
            const bubblesContainer = document.querySelector('.bubbles');
            const existingBubbles = bubblesContainer.querySelectorAll('.bubble:not(.large)');
            existingBubbles.forEach(bubble => bubble.remove());
            
            const bubbleCount = intensity === 'strong' ? 15 : 8;
            
            for (let i = 0; i < bubbleCount; i++) {
                setTimeout(() => {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    bubble.style.width = Math.random() * 10 + 5 + 'px';
                    bubble.style.height = bubble.style.width;
                    bubble.style.left = Math.random() * 80 + 10 + '%';
                    bubble.style.animationDelay = Math.random() * 2 + 's';
                    bubble.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    bubblesContainer.appendChild(bubble);
                }, i * 100);
            }
        }

        function createResultBubbles(results) {
            const beakerContainer = document.querySelector('.beaker-container');
            
            results.forEach((result, index) => {
                setTimeout(() => {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble large';
                    bubble.textContent = result;
                    bubble.style.position = 'absolute';
                    bubble.style.left = (50 + index * 60) + 'px';
                    bubble.style.bottom = '200px';
                    bubble.style.animationDelay = '0.5s';
                    bubble.style.animationDuration = '4s';
                    bubble.style.zIndex = '100';
                    beakerContainer.appendChild(bubble);
                    
                    // Remove bubble after animation completes
                    setTimeout(() => {
                        bubble.remove();
                    }, 5000);
                }, 1000 + index * 500);
            });
        }

        function showReactionText(text) {
            const reactionText = document.querySelector('.reaction-text');
            reactionText.textContent = text;
            reactionText.classList.add('show');
            
            setTimeout(() => {
                reactionText.classList.remove('show');
            }, 3000);
        }

        function startReaction() {
            if (gameState.materialsInBeaker.length < 2) {
                showMessage('تنبيه', 'أضف مادتين على الأقل للتفاعل');
                return;
            }
            
            gameState.reactionInProgress = true;
            checkForReactions();
            
            setTimeout(() => {
                gameState.reactionInProgress = false;
            }, 3000);
        }

        function resetScene() {
            gameState = {
                materialsInBeaker: [],
                currentLiquid: null,
                reactionInProgress: false,
                liquidLevel: 50
            };
            
            const liquidContainer = document.querySelector('.liquid-container');
            const liquid = document.querySelector('.liquid');
            const bubbles = document.querySelector('.bubbles');
            const precipitate = document.querySelector('.precipitate');
            
            liquidContainer.style.height = '50px';
            liquid.className = 'liquid';
            liquid.style.background = '';
            bubbles.innerHTML = '';
            precipitate.style.display = 'none';
            
            showMessage('إعادة التعيين', 'تم إعادة تعيين التجربة');
        }

        function showExplanation() {
            const explanation = `
                <strong>مرحباً في مختبر الكيمياء التفاعلي!</strong><br><br>
                
                <strong>كيفية اللعب:</strong><br>
                1. اسحب المواد الكيميائية من اللوحة اليسرى<br>
                2. أفلتها في الكأس المركزي<br>
                3. اضغط "ابدأ التفاعل" لمشاهدة النتائج<br><br>
                
                <strong>التفاعلات الممكنة:</strong><br>
                • حمض + قاعدة = تعادل<br>
                • فلز + حمض = غاز الهيدروجين<br>
                • كبريتات النحاس + فلز = ترسيب<br>
                • اللافلزات + حمض = لا يحدث تفاعل<br><br>
                
                <strong>نصائح:</strong><br>
                • جرب مجموعات مختلفة من المواد<br>
                • لاحظ تغيرات اللون والفقاعات<br>
                • استمتع بتعلم الكيمياء!
            `;
            
            showMessage('شرح التجربة', explanation);
        }

        function showMessage(title, content) {
            const messageBox = document.getElementById('messageBox');
            const messageTitle = document.getElementById('messageTitle');
            const messageContent = document.getElementById('messageContent');
            
            messageTitle.textContent = title;
            messageContent.innerHTML = content;
            messageBox.style.display = 'block';
        }

        function closeMessage() {
            document.getElementById('messageBox').style.display = 'none';
        }
    </script>
</body>
</html>
